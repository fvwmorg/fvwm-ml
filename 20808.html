<?xml version="1.0" encoding="us-ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>Re: FVWM: Patch: balloon help for Pager from Richard Lister on 1997-08-27 (fvwm-users)</title>
<meta name="Author" content="Richard Lister (ric_at_giccs.georgetown.edu)" />
<meta name="Subject" content="Re: FVWM: Patch: balloon help for Pager" />
<meta name="Date" content="1997-08-27" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<h1>Re: FVWM: Patch: balloon help for Pager</h1>
<!-- received="Tue Aug 26 23:43:59 1997" -->
<!-- isoreceived="19970826224359" -->
<!-- sent="Wed, 27 Aug 1997 00:44:45 -0400" -->
<!-- isosent="19970827044445" -->
<!-- name="Richard Lister" -->
<!-- email="ric_at_giccs.georgetown.edu" -->
<!-- subject="Re: FVWM: Patch: balloon help for Pager" -->
<!-- id="199708270438.AAA25244_at_murphy.giccs.georgetown.edu" -->
<!-- charset="us-ascii" -->
<!-- inreplyto="Tue, 26 Aug 1997 19:49:02 -0400&quot;" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start20808" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="20809.html" accesskey="d" title="Fractture: &quot;FVWM: Stability of new release&quot;">Next message</a> ]
[ <a href="20807.html" title="Kendrick Vargas: &quot;Re: FVWM: animated &#0034;windowshade&#0034;&quot;">Previous message</a> ]
[ <a href="20806.html" title="Richard Lister: &quot;FVWM: Patch: balloon help for Pager&quot;">Maybe in reply to</a> ]
<!-- unextthread="start" -->
[ <a href="20811.html" accesskey="t" title="Martin Cartwright: &quot;Re: FVWM: Patch: balloon help for Pager&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#msg20808" title="Contemporary messages by date">by date</a> ] [ <a href="index.html#msg20808" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg20808" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg20808" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Richard Lister &lt;<a href="mailto:ric_at_giccs.georgetown.edu?Subject=Re%3A%20FVWM%3A%20Patch%3A%20balloon%20help%20for%20Pager">ric_at_giccs.georgetown.edu</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Wed, 27 Aug 1997 00:44:45 -0400</span><br />
</address>
<br />
On Tue, 26 Aug 1997 19:49:02 -0400
<br />
Richard Lister &lt;ric_at_giccs.georgetown.edu&gt; 
<br />
wrote concerning 'FVWM: Patch: balloon help for Pager':
<br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; I've only tested on Linux/X11R6 so far.
</em><br />
<br />Well, that'll teach me, won't it! I just went to test it on Solaris
<br />
before going home for my tea and it blew up in my face. So its now
<br />
several hours later and I'm v hungry but I've fixed the problem.
<br />
<br />Turns out I had done something very stupid with a pointer. Inexplicably
<br />
Linux let me get away with it, but Irix and Solaris weren't quite so
<br />
forgiving. Appropriately enough the pointer was called 'dummy' :-)
<br />
<br />So, humble apologies for the previous broken patch, and here's a new
<br />
one, tested on Linux/X11R6, Solaris 2.5/OpenWindows, and Irix 6.3.
<br />
<br />For some reason the diff I made doesn't work with either Solaris or
<br />
GNU patch on my Sun box, though it's fine on Linux and SGI. Tried
<br />
both unified and context diffs. Any patch gurus out there with ideas?
<br />
Meantime, if you have trouble, get the tarball off the web:
<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.giccs.georgetown.edu/~ric/software/fvwm/pager.html">http://www.giccs.georgetown.edu/~ric/software/fvwm/pager.html</a>
<br />
<br /><br />Right, following that egg on my face I'm off for some egg on toast for
<br />
my tea.
<br />
<br />Ric
<br />
<br />Richard J Lister, Georgetown Institute for Cognitive and Computational Sciences
<br />
Georgetown University Medical Center, Washington, DC.
<br />
Phone: 202-687 2878
<br />
Email: ric_at_giccs.georgetown.edu 
<br />
Web: <a href="http://www.giccs.georgetown.edu/">http://www.giccs.georgetown.edu/</a>
<br />
<br /><br />------------------------------cut here-----------------------------------
<br />
diff -rc modules/FvwmPager.orig/FvwmPager.c modules/FvwmPager/FvwmPager.c
<br />
*** modules/FvwmPager.orig/FvwmPager.c	Tue Aug 26 18:46:54 1997
<br />
--- modules/FvwmPager/FvwmPager.c	Tue Aug 26 18:55:02 1997
<br />
***************
<br />
*** 68,73 ****
<br />
--- 68,78 ----
<br />
&nbsp;&nbsp;char *WindowHiBack = NULL;
<br />
&nbsp;&nbsp;char *WindowHiFore = NULL;
<br />
&nbsp;&nbsp;
<br />
+ int ShowBalloons = 0;
<br />
+ char *BalloonBack = NULL;
<br />
+ char *BalloonFore = NULL;
<br />
+ char *BalloonFont = &quot;fixed&quot;;
<br />
+ 
<br />
&nbsp;&nbsp;int window_w=0, window_h=0, window_x=0, window_y=0;
<br />
&nbsp;&nbsp;int icon_x=-10000, icon_y=-10000, icon_w=0, icon_h=0;
<br />
&nbsp;&nbsp;int usposition = 0,uselabel = 1;
<br />
***************
<br />
*** 1060,1065 ****
<br />
--- 1065,1100 ----
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colors = GetNextToken (colors, &amp;WindowHiBack);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br />
+ 
<br />
+       
<br />
+       /* ... and get Balloon config options ...
<br />
+          -- ric_at_giccs.georgetown.edu */
<br />
+       else if ( (strlen(&amp;tline[0]) &gt; 1) &amp;&amp;
<br />
+                 (strncasecmp (tline, CatString3 (&quot;*&quot;, MyName, &quot;Balloons&quot;),
<br />
+                               Clength + 9) == 0) ) {
<br />
+         ShowBalloons = 1;
<br />
+       }
<br />
+ 
<br />
+       else if ( (strlen(&amp;tline[0]) &gt; 1) &amp;&amp;
<br />
+                 (strncasecmp (tline, CatString3 (&quot;*&quot;, MyName, &quot;BalloonBack&quot;),
<br />
+                               Clength + 12) == 0) ) {
<br />
+         if (Scr.d_depth &gt; 1)
<br />
+           CopyString(&amp;BalloonBack, &amp;tline[Clength+12]);
<br />
+       }
<br />
+ 
<br />
+       else if ( (strlen(&amp;tline[0]) &gt; 1) &amp;&amp;
<br />
+                 (strncasecmp (tline, CatString3 (&quot;*&quot;, MyName, &quot;BalloonFore&quot;), 
<br />
+                               Clength + 12) == 0) ) {
<br />
+         if (Scr.d_depth &gt; 1)
<br />
+           CopyString(&amp;BalloonFore, &amp;tline[Clength+12]);
<br />
+       }
<br />
+ 
<br />
+       else if ( (strlen(&amp;tline[0]) &gt; 1) &amp;&amp;
<br />
+                 (strncasecmp (tline, CatString3 (&quot;*&quot;, MyName, &quot;BalloonFont&quot;), 
<br />
+                               Clength + 12) == 0) ) {
<br />
+         CopyString(&amp;BalloonFont, &amp;tline[Clength+12]);
<br />
+       }
<br />
+ 
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetConfigLine(fd,&amp;tline);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br />
&nbsp;&nbsp;&nbsp;&nbsp;return;
<br />
diff -rc modules/FvwmPager.orig/FvwmPager.h modules/FvwmPager/FvwmPager.h
<br />
*** modules/FvwmPager.orig/FvwmPager.h	Tue Aug 26 18:46:55 1997
<br />
--- modules/FvwmPager/FvwmPager.h	Tue Aug 26 18:55:02 1997
<br />
***************
<br />
*** 68,73 ****
<br />
--- 68,81 ----
<br />
&nbsp;&nbsp;} PagerWindow;
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;
<br />
+ typedef struct balloon_window
<br />
+ {
<br />
+   Window w;              /* ID of balloon window */
<br />
+   PagerWindow *pw;       /* pager window it's associated with */
<br />
+   XFontStruct *font;
<br />
+ } BalloonWindow;
<br />
+ 
<br />
+ 
<br />
&nbsp;&nbsp;typedef struct desk_info 
<br />
&nbsp;&nbsp;{
<br />
&nbsp;&nbsp;&nbsp;&nbsp;Window w;
<br />
***************
<br />
*** 144,149 ****
<br />
--- 152,161 ----
<br />
&nbsp;&nbsp;void IconMoveWindow(XEvent *Event,PagerWindow *t);
<br />
&nbsp;&nbsp;void HandleExpose(XEvent *Event);
<br />
&nbsp;&nbsp;void MoveStickyWindows(void);
<br />
+ void MapBalloonWindow(XEvent *);
<br />
+ void UnmapBalloonWindow(void);
<br />
+ void DrawInBalloonWindow(void);
<br />
+ 
<br />
&nbsp;&nbsp;#ifdef BROKEN_SUN_HEADERS
<br />
&nbsp;&nbsp;#include &quot;../../fvwm/sun_headers.h&quot;
<br />
&nbsp;&nbsp;#endif
<br />
diff -rc modules/FvwmPager.orig/FvwmPager.man modules/FvwmPager/FvwmPager.man
<br />
*** modules/FvwmPager.orig/FvwmPager.man	Tue Aug 26 18:46:55 1997
<br />
--- modules/FvwmPager/FvwmPager.man	Tue Aug 26 18:55:02 1997
<br />
***************
<br />
*** 181,190 ****
<br />
&nbsp;&nbsp;Allow the pager to display a window's mini icon in the pager, if it has
<br />
&nbsp;&nbsp;one, instead of showing the window's name.
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;.SH AUTHOR
<br />
&nbsp;&nbsp;Robert Nation 
<br />
&nbsp;&nbsp;.br
<br />
&nbsp;&nbsp;DeskColor patch contributed by Alan Wild
<br />
&nbsp;&nbsp;.br
<br />
&nbsp;&nbsp;MiniIcons and WindowColors patch contributed by Rob Whapham
<br />
! 
<br />
--- 181,208 ----
<br />
&nbsp;&nbsp;Allow the pager to display a window's mini icon in the pager, if it has
<br />
&nbsp;&nbsp;one, instead of showing the window's name.
<br />
&nbsp;&nbsp;
<br />
+ .IP &quot;*FvwmPagerBalloons&quot;
<br />
+ Show a balloon describing the window when the pointer is moved into
<br />
+ a window in the pager. Currently only the window's icon name is shown.
<br />
+ Note that balloons are not shown for the iconified pager. 
<br />
+ 
<br />
+ .IP &quot;*FvwmPagerBalloonFore \fIcolor\fP&quot;
<br />
+ Specifies the color for text in the balloon window. If omitted it
<br />
+ defaults to the foreground color for the window being described.
<br />
+ 
<br />
+ .IP &quot;*FvwmPagerBalloonBack \fIcolor\fP&quot;
<br />
+ Specifies the background color for the balloon window. If omitted it
<br />
+ defaults to the background color for the window being described.
<br />
+ 
<br />
+ .IP &quot;*FvwmPagerBalloonFont \fIfont-name\fP&quot;
<br />
+ Specifies a font to use for the balloon text.
<br />
+ 
<br />
+ 
<br />
&nbsp;&nbsp;.SH AUTHOR
<br />
&nbsp;&nbsp;Robert Nation 
<br />
&nbsp;&nbsp;.br
<br />
&nbsp;&nbsp;DeskColor patch contributed by Alan Wild
<br />
&nbsp;&nbsp;.br
<br />
&nbsp;&nbsp;MiniIcons and WindowColors patch contributed by Rob Whapham
<br />
! .br
<br />
! Balloons patch contributed by Ric Lister &lt;ric_at_giccs.georgetown.edu&gt;
<br />
diff -rc modules/FvwmPager.orig/x_pager.c modules/FvwmPager/x_pager.c
<br />
*** modules/FvwmPager.orig/x_pager.c	Tue Aug 26 18:46:55 1997
<br />
--- modules/FvwmPager/x_pager.c	Tue Aug 26 23:50:36 1997
<br />
***************
<br />
*** 33,44 ****
<br />
--- 33,47 ----
<br />
&nbsp;&nbsp;extern int window_w, window_h,window_x,window_y,usposition,uselabel,xneg,yneg;
<br />
&nbsp;&nbsp;extern int StartIconic;
<br />
&nbsp;&nbsp;extern int MiniIcons;
<br />
+ extern int ShowBalloons;
<br />
+ 
<br />
&nbsp;&nbsp;extern int icon_w, icon_h, icon_x, icon_y;
<br />
&nbsp;&nbsp;XFontStruct *font, *windowFont;
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;GC NormalGC,DashedGC,HiliteGC,rvGC;
<br />
&nbsp;&nbsp;GC StdGC;
<br />
&nbsp;&nbsp;GC MiniIconGC;
<br />
+ GC BalloonGC;
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;extern PagerWindow *Start;
<br />
&nbsp;&nbsp;extern PagerWindow *FocusWin;
<br />
***************
<br />
*** 74,79 ****
<br />
--- 77,83 ----
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;Window		icon_win;               /* icon window */
<br />
+ BalloonWindow balloon;            /* balloon window */
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;/***********************************************************************
<br />
&nbsp;&nbsp;&nbsp;*
<br />
***************
<br />
*** 107,112 ****
<br />
--- 111,117 ----
<br />
&nbsp;&nbsp;&nbsp;&nbsp;XSetWindowAttributes attributes;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;extern char *PagerFore, *PagerBack, *HilightC;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;extern char *WindowBack, *WindowFore, *WindowHiBack, *WindowHiFore;
<br />
+   extern char *BalloonFore, *BalloonBack, *BalloonFont;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;extern char *font_string, *smallFont;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;int n,m,w,h,i,x,y;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;XGCValues gcv;
<br />
***************
<br />
*** 402,407 ****
<br />
--- 407,456 ----
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gcv.background = back_pix;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gcv.line_style = LineOnOffDash;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DashedGC = XCreateGC(dpy, Scr.Root, gcm, &amp;gcv);
<br />
+ 
<br />
+ 
<br />
+   /* create balloon window
<br />
+      -- ric_at_giccs.georgetown.edu */
<br />
+   if ( ShowBalloons ) {
<br />
+ 
<br />
+     /* tell WM to ignore this window */
<br />
+     attributes.override_redirect = True;
<br />
+   
<br />
+     attributes.event_mask = ExposureMask;
<br />
+ 
<br />
+     /* if given in config set this now, otherwise it'll be set for each
<br />
+        pager window when drawn later */
<br />
+     attributes.background_pixel = 
<br />
+       (BalloonBack == NULL) ? 0 : GetColor(BalloonBack);
<br />
+ 
<br />
+     /* get font for balloon */
<br />
+     if ( (balloon.font = XLoadQueryFont(dpy, BalloonFont)) == NULL ) {
<br />
+       if ( (balloon.font = XLoadQueryFont(dpy, &quot;fixed&quot;)) == NULL ) {
<br />
+         fprintf(stderr,&quot;%s: No fonts available.\n&quot;, MyName);
<br />
+         exit(1);
<br />
+       }
<br />
+       fprintf(stderr, &quot;%s: Can't find font '%s', using fixed.\n&quot;,
<br />
+               MyName, BalloonFont);
<br />
+     }
<br />
+ 
<br />
+     balloon.w = XCreateWindow(dpy, Scr.Root, 
<br />
+                               0, 0,            /* coords set later */
<br />
+                               1,               /* width set later */
<br />
+                               balloon.font-&gt;ascent + balloon.font-&gt;descent + 1,
<br />
+                               1,               /* border */
<br />
+                               CopyFromParent,
<br />
+                               InputOutput,
<br />
+                               CopyFromParent,
<br />
+                               CWOverrideRedirect | CWEventMask | CWBackPixel,
<br />
+                               &amp;attributes);
<br />
+ 
<br />
+     /* make gc for balloon */
<br />
+     gcv.font = balloon.font-&gt;fid;
<br />
+ 
<br />
+     BalloonGC = XCreateGC(dpy, balloon.w,
<br />
+                           GCFont,
<br />
+                           &amp;gcv);
<br />
+   } /* ShowBalloons */
<br />
&nbsp;&nbsp;}
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;
<br />
***************
<br />
*** 449,454 ****
<br />
--- 498,511 ----
<br />
&nbsp;&nbsp;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;switch(Event-&gt;xany.type)
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
<br />
+     case EnterNotify:
<br />
+       if ( ShowBalloons )
<br />
+         MapBalloonWindow(Event);
<br />
+       break;
<br />
+     case LeaveNotify:
<br />
+       if ( ShowBalloons )
<br />
+         UnmapBalloonWindow();
<br />
+       break;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ConfigureNotify:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReConfigure();
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
<br />
***************
<br />
*** 556,561 ****
<br />
--- 613,624 ----
<br />
&nbsp;&nbsp;&nbsp;&nbsp;int i;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PagerWindow *t;
<br />
&nbsp;&nbsp;
<br />
+   /* ric_at_giccs.georgetown.edu */
<br />
+   if ( Event-&gt;xany.window == balloon.w ) {
<br />
+     DrawInBalloonWindow();
<br />
+     return;
<br />
+   }
<br />
+ 
<br />
&nbsp;&nbsp;&nbsp;&nbsp;for(i=0;i&lt;ndesks;i++)
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((Event-&gt;xany.window == Desks[i].w)
<br />
***************
<br />
*** 953,958 ****
<br />
--- 1016,1025 ----
<br />
&nbsp;&nbsp;&nbsp;&nbsp;attributes.border_pixel = fore_pix;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;attributes.event_mask = (ExposureMask);
<br />
&nbsp;&nbsp;
<br />
+   /* ric_at_giccs.georgetown.edu -- added Enter and Leave events for 
<br />
+      popping up balloon window */
<br />
+   attributes.event_mask = (ExposureMask | EnterWindowMask | LeaveWindowMask);
<br />
+ 
<br />
&nbsp;&nbsp;&nbsp;&nbsp;if((i &gt;= 0)&amp;&amp; (i &lt;ndesks))
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;PagerView = XCreateWindow(dpy,Desks[i].w, x, y, w, h,1,
<br />
***************
<br />
*** 1804,1807 ****
<br />
--- 1871,1942 ----
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSetInputFocus (dpy, t-&gt;w, RevertToParent, Event-&gt;xbutton.time);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br />
&nbsp;&nbsp;
<br />
+ }
<br />
+ 
<br />
+ 
<br />
+ /* Just maps window ... draw stuff in it later after Expose event
<br />
+    -- ric_at_giccs.georgetown.edu */
<br />
+ void MapBalloonWindow (XEvent *event)
<br />
+ {
<br />
+   PagerWindow *t;
<br />
+   Window dummy;
<br />
+   XWindowChanges window_changes;
<br />
+   extern char *BalloonBack;
<br />
+   
<br />
+   /* is this the best way to match X event window ID to PagerWindow ID? */
<br />
+   t = Start;
<br />
+ 
<br />
+   while ( (t != NULL) &amp;&amp; (t-&gt;PagerView != event-&gt;xcrossing.window) )
<br />
+     t = t-&gt;next;
<br />
+ 
<br />
+   if (t == NULL)
<br />
+     return; 
<br />
+ 
<br />
+   /* associate balloon with its pager window */
<br />
+   balloon.pw = t;
<br />
+ 
<br />
+   /* balloon is a top-level window, therefore need to
<br />
+      translate pager window coords to root window coords */
<br />
+   XTranslateCoordinates(dpy, t-&gt;PagerView, Scr.Root, 
<br />
+                         t-&gt;pager_view_width / 2,
<br />
+                         t-&gt;pager_view_height + 5,
<br />
+                         &amp;window_changes.x, &amp;window_changes.y,
<br />
+                         &amp;dummy);
<br />
+ 
<br />
+   /* change window width to accomodate string */
<br />
+   window_changes.width = 4 + XTextWidth(balloon.font, t-&gt;icon_name,
<br />
+                                         strlen(t-&gt;icon_name));
<br />
+   XConfigureWindow(dpy, balloon.w,
<br />
+                    CWX | CWY | CWWidth,
<br />
+                    &amp;window_changes);
<br />
+ 
<br />
+   /* if background not set in config make it match pager window */
<br />
+   if ( BalloonBack == NULL )
<br />
+     XSetWindowBackground(dpy, balloon.w, t-&gt;back);
<br />
+ 
<br />
+ 
<br />
+   XMapRaised(dpy, balloon.w);
<br />
+ }
<br />
+ 
<br />
+ 
<br />
+ /* -- ric_at_giccs.georgetown.edu */
<br />
+ void UnmapBalloonWindow (void)
<br />
+ {
<br />
+   XUnmapWindow(dpy, balloon.w);
<br />
+ }
<br />
+ 
<br />
+ 
<br />
+ /* Draws string in balloon window -- call after it's received Expose event
<br />
+    -- ric_at_giccs.georgetown.edu */
<br />
+ void DrawInBalloonWindow (void)
<br />
+ {
<br />
+   extern char *BalloonFore;
<br />
+ 
<br />
+   /* if foreground not set in config make it match pager window */
<br />
+   if ( BalloonFore == NULL ) 
<br />
+     XSetForeground(dpy, BalloonGC, balloon.pw-&gt;text);
<br />
+ 
<br />
+   XDrawString(dpy, balloon.w, BalloonGC,
<br />
+               2, balloon.font-&gt;ascent, 
<br />
+               balloon.pw-&gt;icon_name, strlen(balloon.pw-&gt;icon_name));
<br />
&nbsp;&nbsp;}
<br />
<pre>
--
Visit the official FVWM web page at &lt;URL:<a href="http://www.hpc.uh.edu/fvwm/">http://www.hpc.uh.edu/fvwm/</a>&gt;.
To unsubscribe from the list, send &quot;unsubscribe fvwm&quot; in the body of a
message to majordomo_at_hpc.uh.edu.
To report problems, send mail to fvwm-owner_at_hpc.uh.edu.
</pre>
<span id="received"><dfn>Received on</dfn> Tue Aug 26 1997 - 23:43:59 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start20808">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="20809.html" title="Next message in the list">Fractture: "FVWM: Stability of new release"</a></li>
<li><dfn>Previous message</dfn>: <a href="20807.html" title="Previous message in the list">Kendrick Vargas: "Re: FVWM: animated &#0034;windowshade&#0034;"</a></li>
<li><dfn>Maybe in reply to</dfn>: <a href="20806.html" title="Message to which this message replies">Richard Lister: "FVWM: Patch: balloon help for Pager"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="20811.html" title="Next message in this discussion thread">Martin Cartwright: "Re: FVWM: Patch: balloon help for Pager"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="20811.html" title="Message sent in reply to this message">Martin Cartwright: "Re: FVWM: Patch: balloon help for Pager"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#msg20808" title="Contemporary messages by date">by date</a> ] [ <a href="index.html#msg20808" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg20808" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg20808" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Mon Aug 29 2016 - 19:38:00 BST
</em></small></p>
</body>
</html>
