<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>FVWM: FvwmPager patch from Thimo Jansen on 1997-02-09 (fvwm-users)</title>
<meta name="Author" content="Thimo Jansen (teejay_at_Cam031102.student.utwente.nl)" />
<meta name="Subject" content="FVWM: FvwmPager patch" />
<meta name="Date" content="1997-02-09" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<h1>FVWM: FvwmPager patch</h1>
<!-- received="Sat Feb  8 18:49:35 1997" -->
<!-- isoreceived="19970208184935" -->
<!-- sent="Sun, 9 Feb 1997 01:49:07 +0100" -->
<!-- isosent="19970209004907" -->
<!-- name="Thimo Jansen" -->
<!-- email="teejay_at_Cam031102.student.utwente.nl" -->
<!-- subject="FVWM: FvwmPager patch" -->
<!-- id="19970209014907.60358_at_Ferrenzo.student.utwente.nl" -->
<!-- charset="US-ASCII" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start19196" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="19197.html" accesskey="d" title="Thimo Jansen: &quot;FVWM: FvwmPager patch (again...)&quot;">Next message</a> ]
[ <a href="19195.html" title="Patrick Haller: &quot;FVWM: Q: FVWM and page size vs. physical screen size.&quot;">Previous message</a> ]
<!-- unextthread="start" -->
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#msg19196" title="Contemporary messages by date">by date</a> ] [ <a href="index.html#msg19196" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg19196" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg19196" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Thimo Jansen &lt;<a href="mailto:teejay_at_Cam031102.student.utwente.nl?Subject=Re%3A%20FVWM%3A%20FvwmPager%20patch">teejay_at_Cam031102.student.utwente.nl</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Sun, 9 Feb 1997 01:49:07 +0100</span><br />
</address>
<br />
--RJ=DfkfpUW7O+AmO
<br />
Content-Type: text/plain; charset=us-ascii
<br />
<br />Hi everyone,
<br />
<br />A little while ago, Rob Whapham (rwhapham_at_hublink.com) posted a patch to
<br />
let the FvwmPager of fvwm95 do mini-icons and the possibility to define
<br />
WindowColors used in the pager.
<br />
<br />Now I've patched my FvwmPager from the fvwm-2.0.45 tree with this patch
<br />
(partly by hand) and made a diff that works with fvwm2. For all of you
<br />
who didn't want, or could, patch with the fvwm95 version of the patch,
<br />
here's the fvwm2 version, as an attachment to this mail.
<br />
<br />To patch FvwmPager, go inside the FvwmPager dir
<br />
(fvwm-2.0.45/modules/FvwmPager) and type &quot;patch -p0 &lt;
<br />
the_location_and_name_of_the_patch_goes_here&quot;. Good luck! :)
<br />
<br />And this is to Chuck. Can you take a look at the code and consider adding
<br />
this to fvwm2? I think this is a great addition, especially the
<br />
WindowColors part. Now with the new-and-enhanced border/titlestyle
<br />
options, I've got all my windows with a Grey75 background. FvwmPager
<br />
became a lot less handy, untill I run into this patch. So (on my knees):
<br />
Please, please add it to fvwm2... ;)
<br />
<br />That's it and that's that. Mail you later.
<br />
<br />Greetings,
<br />
<br />Thimo Jansen
<br />
<pre>
-- 
TeeJay signing off:  Avoid the Gates of Hell.  Use Linux
*** Finger for PGP PUBLIC KEY ***
--RJ=DfkfpUW7O+AmO
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename=&quot;MiniIcons_WindowColors.FvwmPager.patch&quot;
*** FvwmPager.orig.c	Thu Feb  6 12:13:35 1997
--- FvwmPager.c	Thu Feb  6 11:16:43 1997
***************
*** 63,68 ****
--- 63,72 ----
  char *font_string = &quot;fixed&quot;;
  char *smallFont = NULL;
  char *HilightC = &quot;black&quot;;
+ char *WindowBack = NULL;
+ char *WindowFore = NULL;
+ char *WindowHiBack = NULL;
+ char *WindowHiFore = NULL;
  
  int window_w=0, window_h=0, window_x=0, window_y=0;
  int icon_x=-10000, icon_y=-10000, icon_w=0, icon_h=0;
***************
*** 70,78 ****
--- 74,89 ----
  int xneg = 0, yneg = 0;
  extern DeskInfo *Desks;
  int StartIconic = 0;
+ int	MiniIcons = 0;
  int Rows = -1, Columns = -1;
  int desk1=0, desk2 =0;
  int ndesks = 0;
+ 
+ Pixel win_back_pix = -1;
+ Pixel win_fore_pix = -1;
+ Pixel win_hi_back_pix = -1;
+ Pixel win_hi_fore_pix = -1;
+ 
  /***********************************************************************
   *
   *  Procedure:
***************
*** 174,179 ****
--- 185,191 ----
  		 M_ICON_NAME|
  		 M_CONFIG_INFO|
  		 M_END_CONFIG_INFO|
+ 		 M_MINI_ICON|
  		 M_END_WINDOWLIST);
  #ifdef DEBUG
    fprintf(stderr,&quot;[main]: calling ParseOptions\n&quot;);
***************
*** 262,267 ****
--- 274,282 ----
      case M_ICON_NAME:
        list_icon_name(body);
        break;
+ 	case M_MINI_ICON:
+ 		list_mini_icon(body);
+ 		break;
      case M_END_WINDOWLIST:
        list_end();
        break;
***************
*** 313,325 ****
    (*prev)-&gt;desk = body[7];
    (*prev)-&gt;next = NULL;
    (*prev)-&gt;flags = body[8];
    (*prev)-&gt;icon_name = NULL;
    (*prev)-&gt;title_height = body[9];
    (*prev)-&gt;border_width = body[10];
    (*prev)-&gt;icon_w = body[19];
    (*prev)-&gt;icon_pixmap_w = body[20];
!   (*prev)-&gt;text = body[22];
!   (*prev)-&gt;back = body[23];
    AddNewWindow(*prev);
  }
  
--- 328,353 ----
    (*prev)-&gt;desk = body[7];
    (*prev)-&gt;next = NULL;
    (*prev)-&gt;flags = body[8];
+   (*prev)-&gt;pager_view_width = 0;
+   (*prev)-&gt;pager_view_height = 0;
+   (*prev)-&gt;icon_view_width = 0;
+   (*prev)-&gt;icon_view_height = 0;
    (*prev)-&gt;icon_name = NULL;
+   (*prev)-&gt;mini_icon.picture = 0;
    (*prev)-&gt;title_height = body[9];
    (*prev)-&gt;border_width = body[10];
    (*prev)-&gt;icon_w = body[19];
    (*prev)-&gt;icon_pixmap_w = body[20];
!   if ((win_fore_pix != -1) &amp;&amp; (win_back_pix != -1))
!   {
!         (*prev)-&gt;text = win_fore_pix;
!         (*prev)-&gt;back = win_back_pix;
!   }
!   else
!   {
!         (*prev)-&gt;text = body[22];
!         (*prev)-&gt;back = body[23];
!   }
    AddNewWindow(*prev);
  }
  
***************
*** 358,365 ****
        t-&gt;flags = body[8];
        t-&gt;icon_w = body[19];
        t-&gt;icon_pixmap_w = body[20];
!       t-&gt;text = body[22];
!       t-&gt;back = body[23];
        if(t-&gt;flags &amp; ICONIFIED)
  	{
  	  t-&gt;x = t-&gt;icon_x;
--- 386,401 ----
        t-&gt;flags = body[8];
        t-&gt;icon_w = body[19];
        t-&gt;icon_pixmap_w = body[20];
!         if ((win_fore_pix != -1) &amp;&amp; (win_back_pix != -1))
!         {
!             t-&gt;text = win_fore_pix;
!             t-&gt;back = win_back_pix;
!         }
!         else
!         {
! 	      t-&gt;text = body[22];
! 	      t-&gt;back = body[23];
!         }
        if(t-&gt;flags &amp; ICONIFIED)
  	{
  	  t-&gt;x = t-&gt;icon_x;
***************
*** 440,447 ****
    extern Pixel focus_pix, focus_fore_pix;
    target_w = body[0];
    
!   focus_pix = body[4];
!   focus_fore_pix = body[3];
    t = Start;
    while((t!= NULL)&amp;&amp;(t-&gt;w != target_w))
      {
--- 476,491 ----
    extern Pixel focus_pix, focus_fore_pix;
    target_w = body[0];
    
!   if ((win_hi_fore_pix != -1) &amp;&amp; (win_hi_back_pix != -1))
!   {
!         focus_pix                     = win_hi_back_pix;
!         focus_fore_pix        = win_hi_fore_pix;
!   }
!   else
!   {
!   	focus_pix = body[4];
!   	focus_fore_pix = body[3];
!   }
    t = Start;
    while((t!= NULL)&amp;&amp;(t-&gt;w != target_w))
      {
***************
*** 679,684 ****
--- 723,752 ----
  }
  
  
+ void list_mini_icon(unsigned long *body)
+ {
+ 	PagerWindow	*t;
+ 	Window		target_w;
+ 
+ 	target_w	= body[0];
+ 	t			= Start;
+ 
+ 	while (t &amp;&amp; (t-&gt;w != target_w))
+ 		t = t-&gt;next;
+ 
+ 	if (t)
+ 	{
+ 		t-&gt;mini_icon.picture	= body[1];
+ 		t-&gt;mini_icon.mask		= body[2];
+ 		t-&gt;mini_icon.width		= body[3];
+ 		t-&gt;mini_icon.height		= body[4];
+ 		t-&gt;mini_icon.depth		= body[5];
+ 		PictureWindow (t);
+ 		PictureIconWindow (t);
+ 	}
+ }
+ 
+ 
  
  
  /***********************************************************************
***************
*** 788,793 ****
--- 856,862 ----
  {
    char *tend,*tstart;
    char *tline= NULL,*tmp;
+   char *colors;
    int Clength,n,desk;
  
    Scr.FvwmRoot = NULL;
***************
*** 952,959 ****
  	      (mystrncasecmp(tline,CatString3(&quot;*&quot;,MyName,&quot;SmallFont&quot;),
  			     Clength+10)==0))
  	{
! 	  CopyString(&amp;smallFont,&amp;tline[Clength+10]);
  	}	
        else if((strlen(&amp;tline[0])&gt;1)&amp;&amp;
  	      (mystrncasecmp(tline,CatString3(&quot;*&quot;,MyName,&quot;StartIconic&quot;),
  			     Clength+12)==0))
--- 1021,1039 ----
  	      (mystrncasecmp(tline,CatString3(&quot;*&quot;,MyName,&quot;SmallFont&quot;),
  			     Clength+10)==0))
  	{
! 	  if (MiniIcons == 0)
! 	    CopyString(&amp;smallFont,&amp;tline[Clength+10]);
  	}	
+       else if ((strlen (&amp;tline[0]) &gt; 1) &amp;&amp; (strncasecmp (tline, CatString3 (&quot;*&quot;, MyName, &quot;MiniIcons&quot;), Clength + 9) == 0))
+         {
+               if (smallFont)
+               {
+                       free (smallFont);
+                       smallFont = NULL;
+               }
+ 
+               MiniIcons = 1;
+       }
        else if((strlen(&amp;tline[0])&gt;1)&amp;&amp;
  	      (mystrncasecmp(tline,CatString3(&quot;*&quot;,MyName,&quot;StartIconic&quot;),
  			     Clength+12)==0))
***************
*** 978,986 ****
--- 1058,1149 ----
          {
            sscanf(&amp;tline[Clength+13],&quot;%d&quot;,&amp;Scr.VScale);
          }
+ 	else if ((strlen (&amp;tline[0]) &gt; 1) &amp;&amp; (strncasecmp (tline, CatString3 (&quot;*&quot;, MyName, &quot;WindowColors&quot;), Clength + 13) == 0))
+ 	{
+ 		if (Scr.d_depth &gt; 1)
+ 		{
+ 			colors = &amp;tline[Clength + 13];
+ 			colors = GetNextToken (colors, &amp;WindowFore);
+ 			colors = GetNextToken (colors, &amp;WindowBack);
+ 			colors = GetNextToken (colors, &amp;WindowHiFore);
+ 			colors = GetNextToken (colors, &amp;WindowHiBack);
+ 		}
+ 	}
        GetConfigLine(fd,&amp;tline);
      }
    return;
+ }
+ 
+ char *GetNextToken(char *indata,char **token)
+ { 
+   char *t,*start, *end, *text;
+ 
+   t = indata;
+   if(t == NULL)
+     {
+       *token = NULL;
+       return NULL;
+     }
+   while(isspace(*t)&amp;&amp;(*t != 0))t++;
+   start = t;
+   while(!isspace(*t)&amp;&amp;(*t != 0))
+     {
+       /* Check for qouted text */
+       if(*t == '&quot;')
+ 	{
+ 	  t++;
+ 	  while((*t != '&quot;')&amp;&amp;(*t != 0))
+ 	    {
+ 	      /* Skip over escaped text, ie \&quot; or \space */
+ 	      if((*t == '\\')&amp;&amp;(*(t+1) != 0))
+ 		t++;
+ 	      t++;
+ 	    }
+ 	  if(*t == '&quot;')
+ 	    t++;
+ 	}
+       else
+ 	{
+ 	  /* Skip over escaped text, ie \&quot; or \space */
+ 	  if((*t == '\\')&amp;&amp;(*(t+1) != 0))
+ 	    t++;
+ 	  t++;
+ 	}
+     }
+   end = t;
+ 
+   text = safemalloc(end-start+1);
+   *token = text;
+ 
+   while(start &lt; end)
+     {
+       /* Check for qouted text */
+       if(*start == '&quot;')
+ 	{	
+ 	  start++;
+ 	  while((*start != '&quot;')&amp;&amp;(*start != 0))
+ 	    {
+ 	      /* Skip over escaped text, ie \&quot; or \space */
+ 	      if((*start == '\\')&amp;&amp;(*(start+1) != 0))
+ 		start++;
+ 	      *text++ = *start++;
+ 	    }
+ 	  if(*start == '&quot;')
+ 	    start++;
+ 	}
+       else
+ 	{
+ 	  /* Skip over escaped text, ie \&quot; or \space */
+ 	  if((*start == '\\')&amp;&amp;(*(start+1) != 0))
+ 	    start++;
+ 	  *text++ = *start++;
+ 	}
+     }
+   *text = 0;
+   if(*end != 0)
+     end++;
+ 
+   return end;
  }
  
  
*** FvwmPager.orig.h	Thu Feb  6 12:13:44 1997
--- FvwmPager.h	Thu Feb  6 11:07:05 1997
***************
*** 55,60 ****
--- 55,65 ----
    Window icon_w;
    Window icon_pixmap_w;
    char *icon_name;
+   Picture mini_icon;
+   int pager_view_width;
+   int pager_view_height;
+   int icon_view_width;
+   int icon_view_height;
  
    Window PagerView;
    Window IconView;
***************
*** 82,87 ****
--- 87,93 ----
   * Subroutine Prototypes
   * 
   *************************************************************************/
+ char *GetNextToken(char *indata,char **token);
  void Loop(int *fd);
  void SendInfo(int *fd,char *message,unsigned long window);
  char *safemalloc(int length);
***************
*** 105,110 ****
--- 111,117 ----
  void list_icon_name(unsigned long *body);
  void list_class(unsigned long *body);
  void list_res_name(unsigned long *body);
+ void list_mini_icon(unsigned long *body);
  void list_end(void);
  int My_XNextEvent(Display *dpy, XEvent *event);
  
***************
*** 129,134 ****
--- 136,143 ----
  void MoveWindow(XEvent *Event);
  void LabelWindow(PagerWindow *t);
  void LabelIconWindow(PagerWindow *t);
+ void PictureWindow(PagerWindow *t);
+ void PictureIconWindow(PagerWindow *t);
  void ReConfigureIcons(void);
  void IconSwitchPage(XEvent *Event);
  void IconScroll(int x, int y);
*** FvwmPager.orig.man	Thu Feb  6 12:13:50 1997
--- FvwmPager.man	Thu Feb  6 11:52:28 1997
***************
*** 146,151 ****
--- 146,156 ----
  The active page and desk label will be highlighted by using this
  background pattern instead of the normal background.
  
+ .IP &quot;*FvwmPagerWindowColors \fIfore back hiFore hiBack\fP&quot;
+ Change the normal/highlight colors of the windows. \fIfore\fP and
+ \fIhiFore\fP specify the colors as used for the font inside the windows.
+ \fIback\fP and \fIhiBack\fP are used to fill the windows with.
+ 
  .IP &quot;*FvwmPagerLabel \fIdesk label\fP&quot;
  Assigns the text \fIlabel\fP to desk \fIdesk\fP in the pager window.
  Useful for assigning symbolic names to desktops, ie
***************
*** 172,180 ****
--- 177,191 ----
  used to calculate the pager's size. Things in the pager window
  are shown at 1/\fInumber\fP of the actual size.
  
+ .IP &quot;*FvwmPagerMiniIcons&quot;
+ Allow the pager to display a window's title/mini icon in the pager.
+ 
  
  .SH AUTHOR
  Robert Nation 
  .br
  DeskColor patch contributed by Alan Wild
+ .br
+ MiniIcons and WindowColors patch contributed by Rob Whapham
+ 
  
*** x_pager.orig.c	Thu Feb  6 12:10:10 1997
--- x_pager.c	Thu Feb  6 11:18:05 1997
***************
*** 29,41 ****
--- 29,44 ----
  Pixel back_pix, fore_pix, hi_pix;
  Pixel focus_pix;
  Pixel focus_fore_pix;
+ extern Pixel win_back_pix, win_fore_pix, win_hi_back_pix, win_hi_fore_pix;
  extern int window_w, window_h,window_x,window_y,usposition,uselabel,xneg,yneg;
  extern int StartIconic;
+ extern int MiniIcons;
  extern int icon_w, icon_h, icon_x, icon_y;
  XFontStruct *font, *windowFont;
  
  GC NormalGC,DashedGC,HiliteGC,rvGC;
  GC StdGC;
+ GC MiniIconGC;
  
  extern PagerWindow *Start;
  extern PagerWindow *FocusWin;
***************
*** 103,108 ****
--- 106,112 ----
    unsigned long valuemask;
    XSetWindowAttributes attributes;
    extern char *PagerFore, *PagerBack, *HilightC;
+   extern char *WindowBack, *WindowFore, *WindowHiBack, *WindowHiFore;
    extern char *font_string, *smallFont;
    int n,m,w,h,i,x,y;
    XGCValues gcv;
***************
*** 142,147 ****
--- 146,159 ----
    back_pix = GetColor(PagerBack);
    hi_pix = GetColor(HilightC);
  
+   if (WindowBack &amp;&amp; WindowFore &amp;&amp; WindowHiBack &amp;&amp; WindowHiFore)
+   {
+   	win_back_pix	= GetColor (WindowBack);
+   	win_fore_pix	= GetColor (WindowFore);
+   	win_hi_back_pix	= GetColor (WindowHiBack);
+   	win_hi_fore_pix	= GetColor (WindowHiFore);
+   }
+ 
    /* Load pixmaps for mono use */
    if(Scr.d_depth&lt;2)
      {
***************
*** 361,366 ****
--- 373,379 ----
  
    gcv.font =  font-&gt;fid;
    NormalGC = XCreateGC(dpy, Scr.Root, gcm, &amp;gcv);  
+   MiniIconGC = XCreateGC(dpy, Scr.Root, gcm, &amp;gcv);  
  
    gcv.foreground = hi_pix;
    if(Scr.d_depth &lt; 2)
***************
*** 559,568 ****
--- 572,583 ----
        if(t-&gt;PagerView == Event-&gt;xany.window)
  	{
  	  LabelWindow(t);
+ 	  PictureWindow(t);
  	}
        else if(t-&gt;IconView == Event-&gt;xany.window)
  	{
  	  LabelIconWindow(t);
+ 	  PictureIconWindow(t);
  	}
        
        t = t-&gt;next;
***************
*** 724,729 ****
--- 739,747 ----
        if (h &lt; 1)
  	h = 1;
        
+       t-&gt;icon_view_width      = w;
+       t-&gt;icon_view_height     = h;
+ 
        if(Scr.CurrentDesk == t-&gt;desk)
  	XMoveResizeWindow(dpy,t-&gt;IconView,x,y,w,h);
        else
***************
*** 930,935 ****
--- 948,956 ----
    if(h&lt;1)
      h = 1;
  
+ 	t-&gt;pager_view_width		= w;
+ 	t-&gt;pager_view_height	= h;
+       
    valuemask = (CWBackPixel | CWBorderPixel | CWEventMask);
    attributes.background_pixel = t-&gt;back;
    attributes.border_pixel = fore_pix;
***************
*** 959,964 ****
--- 980,988 ----
    if(h&lt;1)
      h = 1;
  
+ 	t-&gt;icon_view_width	= w;
+ 	t-&gt;icon_view_height	= h;
+       
    if(Scr.CurrentDesk == t-&gt;desk)
      {
        t-&gt;IconView = XCreateWindow(dpy,icon_win, x, y, w, h,1,
***************
*** 1010,1015 ****
--- 1034,1043 ----
      w = 1;
    if (h &lt; 1)
      h = 1;
+ 
+ 	t-&gt;pager_view_width		= w;
+ 	t-&gt;pager_view_height	= h;
+       
    if((i &gt;= 0)&amp;&amp;(i &lt; ndesks))
      {
        XReparentWindow(dpy, t-&gt;PagerView, Desks[i].w, x,y);
***************
*** 1030,1035 ****
--- 1058,1067 ----
      w = 1;
    if (h &lt; 1)
      h = 1;
+ 
+ 	t-&gt;icon_view_width	= w;
+ 	t-&gt;icon_view_height	= h;
+ 
    if(Scr.CurrentDesk == t-&gt;desk)
      XMoveResizeWindow(dpy,t-&gt;IconView,x,y,w,h);
    else
***************
*** 1055,1060 ****
--- 1087,1096 ----
      w = 1;
    if (h &lt; 1)
      h = 1;
+ 
+ 	t-&gt;pager_view_width		= w;
+ 	t-&gt;pager_view_height	= h;
+ 
    if(t-&gt;PagerView != None)
      XMoveResizeWindow(dpy,t-&gt;PagerView,x,y,w,h);
    else if((t-&gt;desk &gt;= desk1)&amp;&amp;(t-&gt;desk &lt;= desk2))
***************
*** 1075,1080 ****
--- 1111,1120 ----
      w = 1;
    if (h &lt; 1)
      h = 1;
+ 
+ 	t-&gt;icon_view_width	= w;
+ 	t-&gt;icon_view_height	= h;
+       
    if(Scr.CurrentDesk == t-&gt;desk)
      XMoveResizeWindow(dpy,t-&gt;IconView,x,y,w,h);
    else
***************
*** 1159,1164 ****
--- 1199,1206 ----
    XClearWindow(dpy,t-&gt;IconView);
    LabelWindow(t);
    LabelIconWindow(t);
+   PictureWindow(t);
+   PictureIconWindow(t);
  }
  
  void Scroll(int Desk, int x, int y)
***************
*** 1539,1544 ****
--- 1581,1587 ----
        Globalgcv.foreground = focus_fore_pix;
        Globalgcv.background = focus_pix;
        Globalgcm = GCForeground|GCBackground;
+       XChangeGC(dpy,StdGC,Globalgcm,&amp;Globalgcv); 
      }
    else
      {
***************
*** 1552,1557 ****
--- 1595,1700 ----
    XDrawString (dpy, t-&gt;IconView,StdGC,2,windowFont-&gt;ascent+2 , 
  	       t-&gt;icon_name, strlen(t-&gt;icon_name));        
  
+ }
+ 
+ void PictureWindow (PagerWindow *t)
+ {
+ 	XGCValues		Globalgcv;
+ 	unsigned long	Globalgcm;
+ 	int				iconX;
+ 	int				iconY;
+ 
+ 	if (MiniIcons)
+ 	{
+ 		if (t-&gt;mini_icon.picture &amp;&amp; (t-&gt;PagerView != None))
+ 		{
+ 			if (t-&gt;pager_view_width &gt; t-&gt;mini_icon.width)
+ 				iconX = (t-&gt;pager_view_width - t-&gt;mini_icon.width) / 2;
+ 			else if (t-&gt;pager_view_width &lt; t-&gt;mini_icon.width)
+ 				iconX = -((t-&gt;mini_icon.width - t-&gt;pager_view_width) / 2);
+ 			else
+ 				iconX = 0;
+ 
+ 			if (t-&gt;pager_view_height &gt; t-&gt;mini_icon.height)
+ 				iconY = (t-&gt;pager_view_height - t-&gt;mini_icon.height) / 2;
+ 			else if (t-&gt;pager_view_height &lt; t-&gt;mini_icon.height)
+ 				iconY = -((t-&gt;mini_icon.height - t-&gt;pager_view_height) / 2);
+ 			else
+ 				iconY = 0;
+ 
+ 			Globalgcm				= GCForeground | GCBackground | GCClipMask | GCClipXOrigin | GCClipYOrigin;
+ 			Globalgcv.clip_mask		= t-&gt;mini_icon.mask;
+ 			Globalgcv.clip_x_origin	= iconX;
+ 			Globalgcv.clip_y_origin	= iconY;
+ 
+ 			if (t == FocusWin)
+ 			{
+ 				Globalgcv.foreground	= focus_fore_pix;
+ 				Globalgcv.background	= focus_pix;
+ 			}
+ 			else
+ 			{
+ 				Globalgcv.foreground	= t-&gt;text;
+ 				Globalgcv.background	= t-&gt;back;
+ 			}
+ 
+ 			XChangeGC (dpy, MiniIconGC, Globalgcm, &amp;Globalgcv);
+ 
+ 			XClearWindow (dpy, t-&gt;PagerView);
+ 			XCopyArea (dpy, t-&gt;mini_icon.picture, t-&gt;PagerView, MiniIconGC,
+ 							0, 0, t-&gt;mini_icon.width, t-&gt;mini_icon.height, iconX, iconY);
+ 		}
+ 	}
+ }
+ 
+ void PictureIconWindow (PagerWindow *t)
+ {
+ 	XGCValues		Globalgcv;
+ 	unsigned long	Globalgcm;
+ 	int				iconX;
+ 	int				iconY;
+ 
+ 	if (MiniIcons)
+ 	{
+ 		if (t-&gt;mini_icon.picture &amp;&amp; (t-&gt;IconView != None))
+ 		{
+ 			if (t-&gt;icon_view_width &gt; t-&gt;mini_icon.width)
+ 				iconX = (t-&gt;icon_view_width - t-&gt;mini_icon.width) / 2;
+ 			else if (t-&gt;icon_view_width &lt; t-&gt;mini_icon.width)
+ 				iconX = -((t-&gt;mini_icon.width - t-&gt;icon_view_width) / 2);
+ 			else
+ 				iconX = 0;
+ 
+ 			if (t-&gt;icon_view_height &gt; t-&gt;mini_icon.height)
+ 				iconY = (t-&gt;icon_view_height - t-&gt;mini_icon.height) / 2;
+ 			else if (t-&gt;icon_view_height &lt; t-&gt;mini_icon.height)
+ 				iconY = -((t-&gt;mini_icon.height - t-&gt;icon_view_height) / 2);
+ 			else
+ 				iconY = 0;
+ 
+ 			Globalgcm				= GCForeground | GCBackground | GCClipMask | GCClipXOrigin | GCClipYOrigin;
+ 			Globalgcv.clip_mask		= t-&gt;mini_icon.mask;
+ 			Globalgcv.clip_x_origin	= iconX;
+ 			Globalgcv.clip_y_origin	= iconY;
+ 
+ 			if (t == FocusWin)
+ 			{
+ 				Globalgcv.foreground	= focus_fore_pix;
+ 				Globalgcv.background	= focus_pix;
+ 			}
+ 			else
+ 			{
+ 				Globalgcv.foreground	= t-&gt;text;
+ 				Globalgcv.background	= t-&gt;back;
+ 			}
+ 
+ 			XChangeGC (dpy, MiniIconGC, Globalgcm, &amp;Globalgcv);
+ 
+ 			XClearWindow (dpy, t-&gt;IconView);
+ 			XCopyArea (dpy, t-&gt;mini_icon.picture, t-&gt;IconView, MiniIconGC,
+ 							0, 0, t-&gt;mini_icon.width, t-&gt;mini_icon.height, iconX, iconY);
+ 		}
+ 	}
  }
  
  void IconMoveWindow(XEvent *Event,PagerWindow *t)
--RJ=DfkfpUW7O+AmO--

</pre>
<br />
<pre>
--
Visit the official FVWM web page at &lt;URL:<a href="http://www.hpc.uh.edu/fvwm/">http://www.hpc.uh.edu/fvwm/</a>&gt;.
To unsubscribe from the list, send &quot;unsubscribe fvwm&quot; in the body of a
message to majordomo_at_hpc.uh.edu.
To report problems, send mail to fvwm-owner_at_hpc.uh.edu.
</pre>
<div>
<ul>
<li>application/pgp-signature attachment: <a href="att-19196/01-part">stored</a></li>
</ul>
<!-- attachment="01-part" -->
</div>
<span id="received"><dfn>Received on</dfn> Sat Feb 08 1997 - 18:49:35 GMT</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start19196">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="19197.html" title="Next message in the list">Thimo Jansen: "FVWM: FvwmPager patch (again...)"</a></li>
<li><dfn>Previous message</dfn>: <a href="19195.html" title="Previous message in the list">Patrick Haller: "FVWM: Q: FVWM and page size vs. physical screen size."</a></li>
<!-- lnextthread="start" -->
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#msg19196" title="Contemporary messages by date">by date</a> ] [ <a href="index.html#msg19196" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg19196" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg19196" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Mon Aug 29 2016 - 19:38:00 BST
</em></small></p>
</body>
</html>
