#--------------------------------------------------------------------
#------- FormFvwmTheme  by Alex Wallis (awol@dove.net.au)
#--------------------------------------------------------------------
# To automatically load the themes created by this module 
# into your .fvwm2rc add the following 2 lines.
# Piperead 'for i in $HOME/.fvwm2_theme.* ; do echo Read $i ; done'
# ModuleSynchronous Timeout 5 FvwmTheme
#--------------------------------------------------------------------
DestroyModuleConfig FormFvwmTheme.*

*FormFvwmTheme.WarpPointer
*FormFvwmTheme.Line center
*FormFvwmTheme.Text "FormFvwmTheme"
*FormFvwmTheme.Line center
*FormFvwmTheme.Text "#------------------------------------------------------------#"
*FormFvwmTheme.Line left
*FormFvwmTheme.Text "Theme Name."
*FormFvwmTheme.Input ThemeName 10 ""
*FormFvwmTheme.Text "     "
*FormFvwmTheme.Button	quit "Load Theme"
*FormFvwmTheme.Command DestroyModuleConfig FormFvwmTheme.Default*
*FormFvwmTheme.Command *FormFvwmTheme.UseData .fvwm2_$(ThemeName).theme *FormFvwmTheme.Default
*FormFvwmTheme.Command Module FvwmForm FormFvwmTheme. 
*FormFvwmTheme.Text "     "
*FormFvwmTheme.Button	quit "Browse Themes"
#*FormFvwmTheme.Command	DestroyModuleConfig FormFvwmTheme.Default*
*FormFvwmTheme.Command	Popup ThemesMenu
*FormFvwmTheme.Command	Module FvwmForm FormFvwmTheme. 
*FormFvwmTheme.Line left
*FormFvwmTheme.Text " no."
*FormFvwmTheme.Text "Colorset Options - see man FvwmTheme for syntax"
*FormFvwmTheme.Line left
*FormFvwmTheme.Input Opt1n 3 ""
*FormFvwmTheme.Input Opt1A 60 ""
*FormFvwmTheme.Line left
*FormFvwmTheme.Input Opt2n 3 ""
*FormFvwmTheme.Input Opt2A 60 ""
*FormFvwmTheme.Line left
*FormFvwmTheme.Input Opt3n 3 ""
*FormFvwmTheme.Input Opt3A 60 ""
*FormFvwmTheme.Line left
*FormFvwmTheme.Input Opt4n 3 ""
*FormFvwmTheme.Input Opt4A 60 ""
*FormFvwmTheme.Line left
*FormFvwmTheme.Input Opt5n 3 ""
*FormFvwmTheme.Input Opt5A 60 ""
*FormFvwmTheme.Line center
*FormFvwmTheme.Text "Test Colorset -->"
*FormFvwmTheme.Text "Foreground"
*FormFvwmTheme.Input TestFore 3 ""
*FormFvwmTheme.Text "Items"
*FormFvwmTheme.Input TestItems 3 ""
*FormFvwmTheme.Line expand
*FormFvwmTheme.Button       quit "F1 - Save" F1 
*FormFvwmTheme.Command DestroyModuleConfig FormFvwmTheme.Default*
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt1n) $(Opt1A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt2n) $(Opt2A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt3n) $(Opt3A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt4n) $(Opt4A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt5n) $(Opt5A)
*FormFvwmTheme.Command !/bin/echo "# This file last created by FormFvwmTheme on: `/bin/date`.\n\
*FvwmThemeColorset "$(Opt1n) $(Opt1A)"\n\
*FvwmThemeColorset "$(Opt2n) $(Opt2A)"\n\
*FvwmThemeColorset "$(Opt3n) $(Opt3A)"\n\
*FvwmThemeColorset "$(Opt4n) $(Opt4A)"\n\
*FvwmThemeColorset "$(Opt5n) $(Opt5A)"" > ${FVWM_USERHOME}/.fvwm2_theme.$(ThemeName)
*FormFvwmTheme.Command !/bin/echo "# This file last created by FormFvwmTheme on: `/bin/date`.\n\
*FormFvwmTheme.DefaultThemeName "$(ThemeName)"\n\
*FormFvwmTheme.DefaultOpt1n "$(Opt1n)"\n\
*FormFvwmTheme.DefaultOpt1A "$(Opt1A)"\n\
*FormFvwmTheme.DefaultOpt2n "$(Opt2n)"\n\
*FormFvwmTheme.DefaultOpt2A "$(Opt2A)"\n\
*FormFvwmTheme.DefaultOpt3n "$(Opt3n)"\n\
*FormFvwmTheme.DefaultOpt3A "$(Opt3A)"\n\
*FormFvwmTheme.DefaultOpt4n "$(Opt4n)"\n\
*FormFvwmTheme.DefaultOpt4A "$(Opt4A)"\n\
*FormFvwmTheme.DefaultOpt5n "$(Opt5n)"\n\
*FormFvwmTheme.DefaultOpt5A "$(Opt5A)"" > ${FVWM_USERHOME}/.fvwm2_$(ThemeName).theme
*FormFvwmTheme.Command *FormFvwmTheme.UseData .fvwm2_$(ThemeName).theme *FormFvwmTheme.Default
*FormFvwmTheme.Command Module FvwmForm FormFvwmTheme.
*FormFvwmTheme.Button       quit "F2 - Test" F2 
*FormFvwmTheme.Command *FormFvwmTheme.Colorset $(TestFore)
*FormFvwmTheme.Command *FormFvwmTheme.ItemColorset $(TestItems)
*FormFvwmTheme.Command !/bin/echo "# This file last created by FormFvwmTheme on: `/bin/date`.\n\
*FormFvwmTheme.DefaultThemeName "$(ThemeName)"\n\
*FormFvwmTheme.DefaultOpt1n "$(Opt1n)"\n\
*FormFvwmTheme.DefaultOpt1A "$(Opt1A)"\n\
*FormFvwmTheme.DefaultOpt2n "$(Opt2n)"\n\
*FormFvwmTheme.DefaultOpt2A "$(Opt2A)"\n\
*FormFvwmTheme.DefaultOpt3n "$(Opt3n)"\n\
*FormFvwmTheme.DefaultOpt3A "$(Opt3A)"\n\
*FormFvwmTheme.DefaultOpt4n "$(Opt4n)"\n\
*FormFvwmTheme.DefaultOpt4A "$(Opt4A)"\n\
*FormFvwmTheme.DefaultOpt5n "$(Opt5n)"\n\
*FormFvwmTheme.DefaultOpt5A "$(Opt5A)"\n\
*FormFvwmTheme.DefaultTestFore "$(TestFore)"\n\
*FormFvwmTheme.DefaultTestItems "$(TestItems)"" > ${FVWM_USERHOME}/.fvwm2_test.theme
*FormFvwmTheme.Command DestroyModuleConfig FormFvwmTheme.Default*
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt1n) $(Opt1A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt2n) $(Opt2A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt3n) $(Opt3A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt4n) $(Opt4A)
*FormFvwmTheme.Command SendToModule FvwmTheme Colorset $(Opt5n) $(Opt5A)
*FormFvwmTheme.Command *FormFvwmTheme.UseData .fvwm2_test.theme *FormFvwmTheme.Default
*FormFvwmTheme.Command Module FvwmForm FormFvwmTheme.
*FormFvwmTheme.Button       restart   "F3 - Reset" F3
*FormFvwmTheme.Button       quit "F4 - Dismiss" F4
*FormFvwmTheme.Command Nop
#*FormFvwmTheme.Command DestroyModuleConfig FormFvwmTheme.Default*
#--------------------------------------------------------------------
# Build a menu of all theme files in ${FVWM_USERHOME}/.fvwm2_*.theme
DestroyMenu ThemesMenu
AddToMenu ThemesMenu Themes title
+ DynamicPopupAction Function MakeThemesMenu

DestroyFunc MakeThemesMenu
AddToFunc MakeThemesMenu
+ I DestroyMenu recreate ThemesMenu
+ I AddToMenu ThemesMenu Themes Title
+ I Piperead 'for i in $HOME/.fvwm2_*.theme ; \
	do echo AddToMenu ThemesMenu "`basename $i`" \
	*FormFvwmTheme.UseData "`basename $i`" *FormFvwmTheme.Default ; done'
