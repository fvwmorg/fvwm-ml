From owner-fvwm-workers@hpc.uh.edu  Sun Mar  8 18:09:42 1998
Received: by sina.hpc.uh.edu (TLB v0.09a (1.20 tibbs 1996/10/09 22:03:07)); Sun, 08 Mar 1998 18:09:42 -0600 (CST)
Received: from postoffice.idirect.com (liv13-7.idirect.com [207.136.107.135]) by sina.hpc.uh.edu (8.7.3/8.7.3) with SMTP id SAA13283; Sun, 8 Mar 1998 18:09:34 -0600 (CST)
Date: Sun, 8 Mar 1998 18:09:34 -0600 (CST)
From: Dating@this.web
Message-Id: <199803090009.SAA13283@sina.hpc.uh.edu>
Subject: From a chat room friend.
Sender: owner-fvwm-workers@hpc.uh.edu
Precedence: list
X-Majordomo: 1.94.jlt7

<HTML>
<BODY LINK="#0000ff" VLINK="#800080">

<FONT SIZE=3><P>Single Canadians, To listen to voice recordings of 
singles in your area or chat in a live chat zone just </FONT><A 
HREF="http://fast.to/dateline">click here.</A></P>
</HTML>
--
Visit the official FVWM web page at <URL:http://www.hpc.uh.edu/fvwm/>.
To unsubscribe from the list, send "unsubscribe fvwm-workers" in the
body of a message to majordomo@hpc.uh.edu.
To report problems, send mail to fvwm-workers-owner@hpc.uh.edu.

From owner-fvwm-workers@hpc.uh.edu  Mon Mar 16 11:51:02 1998
Received: by sina.hpc.uh.edu (TLB v0.09a (1.20 tibbs 1996/10/09 22:03:07)); Mon, 16 Mar 1998 11:51:02 -0600 (CST)
Received: from Toker.DoCS.UU.SE (Toker.DoCS.UU.SE [130.238.8.102]) by sina.hpc.uh.edu (8.7.3/8.7.3) with ESMTP id LAA28957 for <fvwm-workers@hpc.uh.edu>; Mon, 16 Mar 1998 11:50:54 -0600 (CST)
Received: (from johanb@localhost)
	by Toker.DoCS.UU.SE (8.8.7/8.8.7) id SAA19085;
	Mon, 16 Mar 1998 18:50:41 +0100
Date: Mon, 16 Mar 1998 18:50:40 +0100 (CET)
From: Johan Bengtsson <johanb@DoCS.UU.SE>
To: fvwm-workers@hpc.uh.edu
Subject: StickyOnDesk-patch.
X-Mailer: VM 6.43 under 20.4 "Emerald" XEmacs  Lucid
Message-ID: <13581.24451.863110.584115@Toker.DoCS.UU.SE>
Mime-Version: 1.0 (generated by tm-edit 7.108)
Content-Type: multipart/mixed;
 boundary="Multipart_Mon_Mar_16_18:50:40_1998-1"
Content-Transfer-Encoding: 7bit
Sender: owner-fvwm-workers@hpc.uh.edu
Precedence: list
X-Majordomo: 1.94.jlt7

--Multipart_Mon_Mar_16_18:50:40_1998-1
Content-Type: text/plain; charset=US-ASCII


Hi,
I have implemented a version of the StickyOnDesk style option mentioned in
the TODO file for fvwm-2.0.46. In my implementation a window with the
StickyOnDesk feature switched on i "sticky" on the desk where it is
placed, but it won't follow on any other desk.

The StickyOnDesk feature also interact with the normal Sticky and
Slippery styles in such a way that only one of them is active for a
given window at a given time.

regards,
	/ Johan Bengtsson



--Multipart_Mon_Mar_16_18:50:40_1998-1
Content-Type: application/octet-stream; type=patch
Content-Disposition: attachment; filename="fvwm-2.0.46-StickyOnDesk.patch"
Content-Transfer-Encoding: 8bit

diff -u -r fvwm-2.0.46-orig/fvwm/add_window.c fvwm-2.0.46/fvwm/add_window.c
--- fvwm-2.0.46-orig/fvwm/add_window.c	Mon Mar 16 10:59:37 1998
+++ fvwm-2.0.46/fvwm/add_window.c	Mon Mar 16 18:35:46 1998
@@ -215,6 +215,8 @@
   SelectDecor(tmp_win,styles.on_flags,styles.border_width,styles.resize_width); 
 
   tmp_win->flags |= styles.on_flags & ALL_COMMON_FLAGS;
+  tmp_win->xflags |= styles.on_xflags;
+
   /* find a suitable icon pixmap */
   if(styles.on_flags & ICON_FLAG)
     {
@@ -1000,7 +1002,7 @@
 #ifdef USEDECOR
   if (nptr->Decor != NULL) styles->Decor = nptr->Decor;
 #endif
-  if(nptr->off_flags & STARTSONDESK_FLAG)
+  if((nptr->off_flags & STARTSONDESK_FLAG))
     styles->Desk = nptr->Desk;
   if(nptr->off_flags & BW_FLAG)
     styles->border_width = nptr->border_width;
@@ -1012,6 +1014,8 @@
     styles->resize_width = nptr->resize_width;
   styles->on_flags |= nptr->off_flags;  /* combine on and off flags */
   styles->on_flags &= ~(nptr->on_flags);
+  styles->on_xflags |= nptr->off_xflags;  /* combine on and off xflags */
+  styles->on_xflags &= ~(nptr->on_xflags);
   styles->on_buttons |= nptr->off_buttons; /* combine buttons */
   styles->on_buttons &= ~(nptr->on_buttons);
   /* Note, only one style cmd can define a windows iconboxes,
diff -u -r fvwm-2.0.46-orig/fvwm/fvwm.h fvwm-2.0.46/fvwm/fvwm.h
--- fvwm-2.0.46-orig/fvwm/fvwm.h	Mon Mar 16 10:59:36 1998
+++ fvwm-2.0.46/fvwm/fvwm.h	Mon Mar 16 18:35:46 1998
@@ -206,6 +206,8 @@
     Window transientfor;
 
     unsigned long flags;
+    unsigned long xflags;
+
 #ifdef MINI_ICONS
     char *mini_pixmap_file;
     Picture *mini_icon;
@@ -277,6 +279,11 @@
 #define HintOverride            (1<<29)
 #define MWMButtons              (1<<30)
 #define MWMBorders              (1<<31)
+
+/***************************************************************************
+ * extra window flags definitions 
+ ***************************************************************************/
+#define STICKY_ON_DESK		(1<<0)  /* Sticky but stays on desk. */
 
 
 /* flags to suppress/enable title bar buttons */
diff -u -r fvwm-2.0.46-orig/fvwm/fvwm.man fvwm-2.0.46/fvwm/fvwm.man
--- fvwm-2.0.46-orig/fvwm/fvwm.man	Thu Aug  7 16:51:54 1997
+++ fvwm-2.0.46/fvwm/fvwm.man	Mon Mar 16 18:42:57 1998
@@ -1502,7 +1502,7 @@
 \fIoptions\fP is a comma separated list containing some or all of the
 keywords BorderWidth, HandleWidth, NoIcon/Icon, MiniIcon, IconBox,
 NoTitle/Title, NoHandles/Handles, WindowListSkip/WindowListHit,
-CirculateSkip/CirculateHit, StaysOnTop/StaysPut, Sticky/Slippery,
+CirculateSkip/CirculateHit, StaysOnTop/StaysPut, Sticky/StickyOnDesk/Slippery,
 StartIconic/StartNormal, Color, ForeColor, BackColor,
 StartsOnDesk/StartsAnyWhere, IconTitle/NoIconTitle,
 MWMButtons/FvwmButtons, MWMBorder/FvwmBorder, MWMDecor/NoDecorHint,
@@ -1559,6 +1559,9 @@
 
 StickyIcon makes the window sticky when its iconified.  It will
 deiconify on top the active desktop.
+
+StickyOnDesk makes the window sticky on the current desk. Unlike the 
+normal Sticky option the window won't follow to another desk.
 
 MWMButtons makes the Maximize button look pressed-in when the window
 is maximized.  See the MWMButton flag in ButtonStyle for more
diff -u -r fvwm-2.0.46-orig/fvwm/misc.h fvwm-2.0.46/fvwm/misc.h
--- fvwm-2.0.46-orig/fvwm/misc.h	Mon Mar 16 10:59:36 1998
+++ fvwm-2.0.46/fvwm/misc.h	Mon Mar 16 18:35:46 1998
@@ -29,6 +29,10 @@
   int Desk;                        /* Desktop number */
   unsigned long on_flags; 
   unsigned long off_flags; 
+
+  unsigned long on_xflags;
+  unsigned long off_xflags;
+
   int border_width;
   int resize_width;
   char *ForeColor;
@@ -104,6 +108,10 @@
 #ifdef MINI_ICONS
 #define MINIICON_FLAG        (1<<31)
 #endif
+
+/* values for name_list xflags. */
+#define STICKY_ON_DESK_XFLAG (1<<0)
+
 
 /* some fancy font handling stuff */
 #define NewFontAndColor(newfont,color,backcolor) {\
diff -u -r fvwm-2.0.46-orig/fvwm/style.c fvwm-2.0.46/fvwm/style.c
--- fvwm-2.0.46-orig/fvwm/style.c	Mon Mar 16 10:59:36 1998
+++ fvwm-2.0.46/fvwm/style.c	Mon Mar 16 18:35:46 1998
@@ -661,14 +661,22 @@
           SKIP("StaysPut");
           tname.on_flags |= STAYSONTOP_FLAG;	  
         }
+        else if(ITIS("StickyOnDesk"))
+        {
+	  tname.on_flags   |= STICKY_FLAG;
+          tname.off_xflags |= STICKY_ON_DESK_XFLAG;
+          SKIP("StickyOnDesk");
+        }
         else if(ITIS("Sticky"))
         {
           tname.off_flags |= STICKY_FLAG;	  
+          tname.on_xflags |= STICKY_ON_DESK_XFLAG;
           SKIP("Sticky");
         }
         else if(ITIS("Slippery"))
         {
-          tname.on_flags |= STICKY_FLAG;	  
+          tname.on_flags  |= STICKY_FLAG;
+	  tname.on_xflags |= STICKY_ON_DESK_XFLAG;
           SKIP("Slippery");
         }
         else if(ITIS("STARTSONDESK"))
diff -u -r fvwm-2.0.46-orig/fvwm/virtual.c fvwm-2.0.46/fvwm/virtual.c
--- fvwm-2.0.46-orig/fvwm/virtual.c	Mon Mar 16 10:59:34 1998
+++ fvwm-2.0.46/fvwm/virtual.c	Mon Mar 16 18:35:46 1998
@@ -378,7 +378,7 @@
 	  /* If the window is iconified, and sticky Icons is set,
 	   * then the window should essentially be sticky */
 	  if(!((t->flags & ICONIFIED)&&(t->flags & StickyIcon)) &&
-	     (!(t->flags & STICKY)))
+	     (!(t->flags & STICKY)) && (!(t->xflags & STICKY_ON_DESK)))
 	    {
               if(!(t->flags & StickyIcon))
 		{
@@ -407,7 +407,8 @@
 	  /* If its an icon, and its sticking, autoplace it so
 	   * that it doesn't wind up on top a a stationary
 	   * icon */
-	  if(((t->flags & STICKY)||(t->flags & StickyIcon))&&
+	  if(((t->flags & STICKY)||(t->flags & StickyIcon)||
+	      (t->xflags & STICKY_ON_DESK))&&
 	     (t->flags & ICONIFIED)&&(!(t->flags & ICON_MOVED))&&
 	     (!(t->flags & ICON_UNMAPPED)))
 	    AutoPlace(t);
diff -u -r fvwm-2.0.46-orig/fvwm/windows.c fvwm-2.0.46/fvwm/windows.c
--- fvwm-2.0.46-orig/fvwm/windows.c	Mon Mar 16 10:59:35 1998
+++ fvwm-2.0.46/fvwm/windows.c	Mon Mar 16 18:35:46 1998
@@ -210,6 +210,8 @@
           continue; /* don't want icons - skip */
         if (!(flags & SHOW_STICKY) && (t->flags & STICKY))
           continue; /* don't want sticky ones - skip */
+        if (!(flags & SHOW_STICKY) && (t->xflags & STICKY_ON_DESK))
+          continue; /* don't want sticky ones - skip */
         if (!(flags & SHOW_ONTOP) && (t->flags & ONTOP))
           continue; /* don't want ontop ones - skip */
         if (!(flags & SHOW_NORMAL) &&

--Multipart_Mon_Mar_16_18:50:40_1998-1--
--
Visit the official FVWM web page at <URL:http://www.hpc.uh.edu/fvwm/>.
To unsubscribe from the list, send "unsubscribe fvwm-workers" in the
body of a message to majordomo@hpc.uh.edu.
To report problems, send mail to fvwm-workers-owner@hpc.uh.edu.

From owner-fvwm-workers@hpc.uh.edu  Mon Mar 16 17:59:24 1998
Received: by sina.hpc.uh.edu (TLB v0.09a (1.20 tibbs 1996/10/09 22:03:07)); Mon, 16 Mar 1998 17:59:24 -0600 (CST)
Received: from helens.kentek.com (kentek.com [206.247.89.2]) by sina.hpc.uh.edu (8.7.3/8.7.3) with ESMTP id RAA05850 for <fvwm-workers@hpc.uh.edu>; Mon, 16 Mar 1998 17:59:16 -0600 (CST)
Received: from vista.kentek.com by helens.kentek.com with ESMTP
	(1.39.111.2/16.2) id AA256283233; Mon, 16 Mar 1998 17:07:13 -0700
Received: from deb.kentek.com ([172.16.5.69]) by vista.kentek.com with SMTP
	(1.37.109.20/16.2) id AA058413917; Mon, 16 Mar 1998 17:18:37 -0700
Date: Mon, 16 Mar 1998 16:57:13 -0700 (MST)
From: Toshi Isogai <isogai@kentek.com>
Reply-To: Toshi Isogai <isogai@kentek.com>
To: fvwm-workers@hpc.uh.edu
Subject: Drag a window into FvwmPager (and drag-n-drop)
Message-Id: <Pine.LNX.3.96.980316161314.11982I-100000@deb.kentek.com>
Mime-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="279725317-913918727-890091532=:11982"
Content-Id: <Pine.LNX.3.96.980316164034.11982L@deb.kentek.com>
Sender: owner-fvwm-workers@hpc.uh.edu
Precedence: list
X-Majordomo: 1.94.jlt7

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

--279725317-913918727-890091532=:11982
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII
Content-Transfer-Encoding: QUOTED-PRINTABLE
Content-ID: <Pine.LNX.3.96.980316164034.11982M@deb.kentek.com>


I made patches to drag a window/icon into FvwmPager to move the
window/icon.  I also added code to perform drag-and-drop type
operation to a module.=20

The patches are in 2 files. One is for fvwm base code and the other is
for FvwmPager.  Most of the change is done on move.c, builtin.c,
FvwmPager.c, and x_pager.c.  Other files are modified in a few lines
to glue things up or to fix a bug, which is that an icon may not=20
show up when it is drag-out from FvwmPager. (Who would have used this
feature ? It was hard pick an icon on FvwmPager in reasonable size.)

Here is how it works. Firstly, modules tells fvwm2 that they wait for
X events notification. During normal window move or active-placement,
EnterWindow events are checked against these modules. If there is such
a module, normal window move is terminated and send a command string
to the module using M_STRING protocol. Then, the module starts taking
over.

The code is generic so that any modules can be activated.




As an example of drag-in to FvwmPager, this is what happens.
When the new FvwmPager is invoked, it looks for a config line

   *FvwmPagerDragIn [True|False]

(the default is true), then, it sends a command back to fvwm2:

   Notify FvwmPager <window id> EnterWindow

Fvwm2 registers FvwmPager to notify when EnterWindow occurs during
normal window move or active-placement by sending a string to
FvwmPager:=20

   WindowId <window id> EnterWindow




Drag-and-drop type operation has the same principle as the above. At
this time, I don't have any modules to take advantage of this feature
yet. (Therefore, it may have bugs.) The command these modules should
send to main fvwm2 is:=20

   Notify <module name> <window id> ButtonRelease

When a window is dragged and dropped onto the module, it will receive
a string:

   WindowId <window id> ButtonRelease




These Notify commands, which I had to define, can be sent anytime
while the module is active and can be sent from anywhere, it does not
be from the module itself.=20




The string to send FvwmPager can be also used in .fvwm2rc config file.
I have defined mouse 2 on title bar to do pager move.

  Mouse 2 T A SendToModule FvwmPager WindowId $w EnterWindow



You will see a similar but shorter mail and the patch files if you
subscribe fvwm2 mailing list. I assume most of you are. The patch
files are also available at:

  www.concentric.net/~isogai/fvwm2/pager-dragin.patch.gz
  www.concentric.net/~isogai/fvwm2/fvwm-dragin.patch.gz



Any comments are appreciated.


----
P.S.

Chuck,

I didn't receive any comments on the second email. So, I just
went ahead. I believe this change is somewhat closer to what you
said earlier.

-----------------------------------------------------
Toshi Isogai    =B0=EB=B3=AD=CD=F8=CC=C0

KENTEK Information Systems
isogai@kentek.com

--279725317-913918727-890091532=:11982--
--
Visit the official FVWM web page at <URL:http://www.hpc.uh.edu/fvwm/>.
To unsubscribe from the list, send "unsubscribe fvwm-workers" in the
body of a message to majordomo@hpc.uh.edu.
To report problems, send mail to fvwm-workers-owner@hpc.uh.edu.

From owner-fvwm-workers@hpc.uh.edu  Mon Mar 23 08:41:18 1998
Received: by sina.hpc.uh.edu (TLB v0.09a (1.20 tibbs 1996/10/09 22:03:07)); Mon, 23 Mar 1998 08:41:18 -0600 (CST)
Received: from VNET.IBM.COM (vnet.ibm.com [204.146.168.194]) by sina.hpc.uh.edu (8.7.3/8.7.3) with SMTP id IAA26678 for <fvwm-workers@hpc.uh.edu>; Mon, 23 Mar 1998 08:41:11 -0600 (CST)
Received: from FISHKILL by VNET.IBM.COM (IBM VM SMTP V2R4) with BSMTP id 5070;
   Mon, 23 Mar 98 09:40:54 EST
Received: by FISHKILL (XAGENTA 4.0) id 0777; Mon, 23 Mar 1998 09:40:55 -0500 
Received: by cold.fishkill.ibm.com (AIX 4.1/UCB 5.64/4.03)
          id AA44038; Mon, 23 Mar 1998 09:40:49 -0500
From: "Charles Hines" <chuck_hines@VNET.IBM.COM>
Date: Mon, 23 Mar 1998 09:40:43 -0500 (EST)
To: Toshi Isogai <isogai@kentek.com>
Cc: fvwm-workers@hpc.uh.edu
Subject: Re: Drag a window into FvwmPager (and drag-n-drop)
In-Reply-To: <Pine.LNX.3.96.980316161314.11982I-100000@deb.kentek.com>
References: <Pine.LNX.3.96.980316161314.11982I-100000@deb.kentek.com>
X-Mailer: VM 6.43 under 20.4 "Emerald" XEmacs  Lucid
Message-Id: <13590.29629.731134.91038@sstpok-11.pok.ibm.com>
X-Face: 'pn"gAx+&w4-=-}\z>*.Y*@(lC;t1<P);@iwiv';)vn3H2\/.x#;>J[a,/Q.Yv0^Wwc6_"H]}}-"?%)ETS`1v[]P`w4,E.9Bgf*XI4<H{C}Mf@'Ms)z?Bqzf"8v/oY\9K){w}\pw
Sender: owner-fvwm-workers@hpc.uh.edu
Precedence: list
X-Majordomo: 1.94.jlt7

>>>>> "Toshi" == Toshi Isogai <isogai@kentek.com> writes:

(I tried reply to this last week, but my outgoing email has been
messed up lately - hopefully this time it'll make it)

Toshi> I made patches to drag a window/icon into FvwmPager to move the
Toshi> window/icon.  I also added code to perform drag-and-drop type
Toshi> operation to a module.
....
Toshi> The code is generic so that any modules can be activated.
....
Toshi> P.S.

Toshi> Chuck,

Toshi> I didn't receive any comments on the second email.

Oops - sorry about that.

Toshi> So, I just went ahead. I believe this change is somewhat closer
Toshi> to what you said earlier.

Yeah, it does look a little more generic now.  I'll take a look and
play around with it when I get a chance.

Chuck

--
*******************************************************************************
Charles K. Hines <chuck_hines@vnet.ibm.com>
IBM Logic Synthesis Developer [BooleDozer (TM)]
Martial Arts Instructor [Modern Arnis, Presas Style Filipino Martial Arts]

         "Go back to sleep, Chuck.  You're just havin' a nightmare
             -- of course, we ARE still in Hell." (Gary Larson)
*******************************************************************************
--
Visit the official FVWM web page at <URL:http://www.hpc.uh.edu/fvwm/>.
To unsubscribe from the list, send "unsubscribe fvwm-workers" in the
body of a message to majordomo@hpc.uh.edu.
To report problems, send mail to fvwm-workers-owner@hpc.uh.edu.

